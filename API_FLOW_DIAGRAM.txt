â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  ğŸ“Š API CALL FLOW - WHERE & HOW ğŸ“Š                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” QUESTION: Where is project calling API from?

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ THE COMPLETE FLOW
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. USER VISITS PAGE
   â†“
   https://rollnfts.vercel.app/collections
   
2. REACT COMPONENT LOADS
   â†“
   File: src/pages/Collections.jsx
   Line 20: useEffect(() => { loadCollections(); })
   
3. CALLS API SERVICE
   â†“
   Line 26: const response = await collectionsAPI.getAll();
   
4. API SERVICE MAKES REQUEST
   â†“
   File: src/services/api.js
   Line 67: const response = await api.get('/collections');
   
5. AXIOS INTERCEPTS REQUEST
   â†“
   Line 42-44: Sets baseURL = getAPIUrl()
   
6. DETERMINES URL AT RUNTIME
   â†“
   Line 10-31: getAPIUrl() function checks:
   
   IF localhost:
     â†’ http://147.79.78.251:5058/api (external backend - DOWN)
   
   IF production (rollnfts.vercel.app):
     â†’ /api (relative path = same domain)
   
7. FINAL REQUEST URL
   â†“
   https://rollnfts.vercel.app/api/collections
   
8. VERCEL ROUTES TO SERVERLESS FUNCTION
   â†“
   File: api/collections/index.js
   
9. SERVERLESS FUNCTION QUERIES SUPABASE
   â†“
   Line 30: await supabase.from('collections').select('*')
   
10. RETURNS DATA TO FRONTEND
    â†“
    Collections displayed on page

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ KEY FILES IN ORDER
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Frontend Component:
   ğŸ“„ src/pages/Collections.jsx
   - Displays the collections page
   - Calls collectionsAPI.getAll()
   - Has "Sync Blockchain" button

2. API Service Layer:
   ğŸ“„ src/services/api.js
   - Wraps axios calls
   - Determines API URL at runtime
   - Production: /api (relative)
   - Localhost: http://147.79.78.251:5058/api (external)

3. Serverless Function (Backend):
   ğŸ“„ api/collections/index.js
   - Handles GET /api/collections
   - Queries Supabase database
   - Returns all collections as JSON

4. Database:
   ğŸ—„ï¸ Supabase PostgreSQL
   - collections table
   - 176 collections synced from blockchain

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”„ SYNC BLOCKCHAIN FLOW
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

When you click "Sync Blockchain" button:

1. BUTTON CLICK
   â†“
   File: src/pages/Collections.jsx
   Line 38: handleSyncBlockchain()
   
2. CALLS SYNC API
   â†“
   Line 44: axios.post('/api/sync/blockchain')
   
3. SYNC SERVERLESS FUNCTION
   â†“
   File: api/sync/blockchain.js
   
4. FETCHES FROM COREUM BLOCKCHAIN
   â†“
   https://full-node.mainnet-1.coreum.dev:1317/coreum/asset/nft/v1/classes
   
5. STORES IN SUPABASE
   â†“
   supabase.from('collections').upsert(...)
   
6. RETURNS SUCCESS
   â†“
   { success: true, collections: 176 }
   
7. RELOADS COLLECTIONS PAGE
   â†“
   Calls collectionsAPI.getAll() again

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸŒ PRODUCTION URL STRUCTURE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Base: https://rollnfts.vercel.app

Frontend Routes (React Router):
â”œâ”€ /                        â†’ Home page
â”œâ”€ /collections             â†’ Collections list
â”œâ”€ /collection/:id          â†’ Single collection
â”œâ”€ /create-collection       â†’ Create new collection
â””â”€ /profile                 â†’ User profile

API Routes (Vercel Serverless):
â”œâ”€ /api/collections         â†’ List all collections
â”œâ”€ /api/collections/:id     â†’ Get single collection
â”œâ”€ /api/nfts/collection/:id â†’ Get NFTs in collection
â””â”€ /api/sync/blockchain     â†’ Sync from blockchain

External APIs:
â”œâ”€ Coreum Blockchain        â†’ NFT class data
â”œâ”€ Supabase                 â†’ Database storage
â””â”€ IPFS                     â†’ Image storage

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’¡ WHY THIS ARCHITECTURE?
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Before (Broken):
Frontend â†’ /api/* â†’ api/proxy.js â†’ http://147.79.78.251:5058 (DOWN) âŒ

After (Working):
Frontend â†’ /api/collections â†’ api/collections/index.js â†’ Supabase âœ…
Frontend â†’ /api/sync/blockchain â†’ api/sync/blockchain.js â†’ Coreum â†’ Supabase âœ…

Benefits:
âœ… No external backend dependency
âœ… Direct Supabase queries
âœ… Serverless = auto-scaling
âœ… Vercel edge network = fast
âœ… No CORS issues

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” HOW TO VERIFY IT'S WORKING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Open browser DevTools (F12)
2. Go to Network tab
3. Visit: https://rollnfts.vercel.app/collections
4. Look for these requests:

   GET /api/collections â†’ Status 200
   Response: { success: true, data: [176 collections] }

5. Click "Sync Blockchain" button:

   POST /api/sync/blockchain â†’ Status 200
   Response: { success: true, collections: 176 }

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š CURRENT STATE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… API calling from: src/services/api.js
âœ… API URL: /api (relative path on production)
âœ… Backend: api/collections/index.js (serverless function)
âœ… Database: Supabase (176 collections synced)
âœ… Blockchain sync: api/sync/blockchain.js (working)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Status: ğŸŸ¢ All APIs working correctly
Architecture: âœ… Clean serverless setup
Collections: âœ… 176 synced from Coreum

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

